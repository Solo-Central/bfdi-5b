<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
	<base href="https://cdn.jsdelivr.net/gh/Solo-Central/bfdi-5b/">
<style>
    * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
    }

    html, body {
        width: 100%;
        height: 100%;
        margin: 0;
        padding: 0;
        overflow: hidden;
        background: #231F20;
        touch-action: none;    
    }

    #loader {
        position: fixed;
        inset: 0;
        display: flex;
        align-items: center;
        justify-content: center;
        flex-direction: column;
        color: white;
        font-size: 48px;
        font-family: cursive;
        z-index: 10;
        background: #231F20;
        pointer-events: none;        
    }

    #cnv {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        display: block;
        image-rendering: pixelated;
        image-rendering: crisp-edges;
        touch-action: none;
    }
</style>

</head>
<body>

<div id="loader">
    <div id="loading-text">LOADING...</div>
</div>

<canvas id="cnv"></canvas>

<script>
const GAME_WIDTH = 1000;
const GAME_HEIGHT = 1000;

window.cwidth = GAME_WIDTH;
window.cheight = GAME_HEIGHT;
</script>

<script src="https://play.qatual.com/games/ports/bfdi5b/5b.js"></script>

<script>
const canvas = document.getElementById("cnv");
const loadingText = document.getElementById("loading-text");

function resizeCanvas() {
    const windowWidth = window.innerWidth;
    const windowHeight = window.innerHeight;
    
    const scaleX = windowWidth / GAME_WIDTH;
    const scaleY = windowHeight / GAME_HEIGHT;
    const scale = Math.min(scaleX, scaleY);
    
    canvas.width = GAME_WIDTH;
    canvas.height = GAME_HEIGHT;
    canvas.style.width = (GAME_WIDTH * scale) + 'px';
    canvas.style.height = (GAME_HEIGHT * scale) + 'px';
}

window.addEventListener('resize', resizeCanvas);
window.addEventListener('orientationchange', resizeCanvas);

resizeCanvas();

let loadedBytes = 0;

async function fetchWithProgress(url) {
    try {
        const response = await fetch(url);
        if (!response.body) return;

        const reader = response.body.getReader();

        while (true) {
            const { done, value } = await reader.read();
            if (done) break;
            loadedBytes += value?.length || 0;
            logProgress?.(); 
        }
    } catch {
        loadingText.textContent = "SKIPPED BROKEN FILE";
    }
}

async function fetchManifest() {
    return [];
}

async function startLoader() {
    const manifest = await fetchManifest();

    for (const file of manifest) {
        await fetchWithProgress(file);
    }

    document.getElementById("loader").style.display = "none";

    if (typeof window.startGame === "function") {
        window.startGame();
    }
}

startLoader();
</script>

</body>
</html>
